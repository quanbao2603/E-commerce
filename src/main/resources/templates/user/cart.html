<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{user/layout}">

<head>
    <meta charset="UTF-8">
    <title>Giỏ hàng - WOMTech</title>
    <link th:href="@{/css/user/cart.css}" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
<div layout:fragment="content">

    <!-- BREADCRUMB -->
    <section class="bg-light py-3 border-bottom">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-0">
                    <li class="breadcrumb-item"><a th:href="@{/}">Trang chủ</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Giỏ hàng</li>
                </ol>
            </nav>
        </div>
    </section>

    <!-- CART SECTION -->
    <section class="container py-5">
        <h2 class="text-center mb-4 fw-bold"><i class="fa fa-shopping-cart me-2 text-primary"></i>Giỏ hàng của bạn</h2>

        <!-- Giỏ hàng trống -->
        <div th:if="${#lists.isEmpty(cart.items)}" class="text-center py-5 text-muted">
            <i class="fa-solid fa-basket-shopping fa-4x mb-3"></i>
            <h5>Giỏ hàng của bạn đang trống.</h5>
            <a th:href="@{/products}" class="btn btn-primary mt-3">Tiếp tục mua sắm</a>
        </div>

        <!-- Giỏ hàng có sản phẩm -->
        <div th:if="${!#lists.isEmpty(cart.items)}" class="row g-4">
            <div class="col-lg-8">
                <div class="card shadow-sm border-0">
                    <div class="card-body p-0">
                        <table class="table align-middle mb-0">
                            <thead class="table-light">
                            <tr class="text-center">
                                <th style="width: 120px;">Sản phẩm</th>
                                <th class="text-start">Tên</th>
                                <th>Giá</th>
                                <th style="width: 160px;">Số lượng</th>
                                <th>Tổng</th>
                                <th></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="item : ${cart.items}" class="text-center">
                                <!-- Ảnh -->
                                <td>
                                    <img th:src="@{|/images/${item.product.thumbnail}|}" th:alt="${item.product.name}"
                                         class="img-fluid rounded shadow-sm" style="width: 80px;">
                                </td>

                                <!-- Tên -->
                                <td class="text-start">
                                    <a th:href="@{/product/{id}(id=${item.product.productID})}"
                                       class="fw-semibold text-dark text-decoration-none"
                                       th:text="${item.product.name}">Tên sản phẩm</a>
                                </td>

                                <!-- Giá -->
                                <td th:text="${#numbers.formatDecimal(item.product.price, 0, 'COMMA', 0, 'POINT')} + '₫'"></td>

                                <!-- Số lượng -->
                                <td>
                                    <form th:action="@{/cart/update}" method="post"
                                          class="d-flex align-items-center justify-content-center">
                                        <input type="hidden" name="productID" th:value="${item.product.productID}">
                                        <div class="input-group input-group-sm" style="width: 110px;">
                                            <button class="btn btn-outline-secondary btn-decrease" type="button">−</button>
                                            <input type="number" class="form-control text-center" min="1"
                                                   name="quantity" th:value="${item.quantity}">
                                            <button class="btn btn-outline-secondary btn-increase" type="button">+</button>
                                        </div>
                                        <button type="submit" class="btn btn-sm btn-outline-primary ms-2">Lưu</button>
                                    </form>
                                </td>

                                <!-- Tổng -->
                        <!--         <td th:text="${#numbers.formatDecimal(item.total, 0, 'COMMA', 0, 'POINT')} + '₫'"></td> -->

                                <!-- Xóa -->
                                <td>
                                    <form th:action="@{/cart/remove}" method="post"
                                          onsubmit="return confirm('Xóa sản phẩm này khỏi giỏ hàng?')">
                                        <input type="hidden" name="productID" th:value="${item.product.productID}">
                                        <button class="btn btn-sm btn-outline-danger">
                                            <i class="fa fa-trash"></i>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Tóm tắt đơn hàng -->
<!--             <div class="col-lg-4"> -->
<!--                 <div class="card shadow-sm border-0"> -->
<!--                     <div class="card-body"> -->
<!--                         <h5 class="fw-bold mb-3">Tóm tắt đơn hàng</h5> -->

<!--                         <div class="d-flex justify-content-between mb-2"> -->
<!--                             <span>Tổng sản phẩm:</span> -->
<!--                             <strong th:text="${cart.items.size()}"></strong> -->
<!--                         </div> -->
<!--                         <div class="d-flex justify-content-between mb-2"> -->
<!--                             <span>Tổng tiền:</span> -->
<!--                             <strong th:text="${#numbers.formatDecimal(cart.total, 0, 'COMMA', 0, 'POINT')} + '₫'"></strong> -->
<!--                         </div> -->

<!--                         <hr> -->

<!--                         <a th:href="@{/checkout}" class="btn btn-primary w-100"> -->
<!--                             <i class="fa fa-credit-card me-2"></i>Thanh toán -->
<!--                         </a> -->
<!--                         <a th:href="@{/products}" class="btn btn-outline-secondary w-100 mt-2"> -->
<!--                             <i class="fa fa-arrow-left me-2"></i>Tiếp tục mua sắm -->
<!--                         </a> -->
<!--                     </div> -->
<!--                 </div> -->
<!--             </div> -->
        </div>
    </section>
</div>

<!-- SCRIPT -->
<script th:src="@{/js/user/cart.js}"></script>
</body>
</html>
